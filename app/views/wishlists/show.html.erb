<div class="page-container">
  <!-- Wishlist Header -->
  <header class="page-header">
    <div class="header-content">
      <h1 class="page-title"><%= @wishlist.title %></h1>
      <% if @wishlist.description.present? %>
        <p class="page-subtitle"><%= @wishlist.description %></p>
      <% end %>
      <div class="wishlist-meta">
        <turbo-frame id="item_count_badge">
          <%= render "item_count", wishlist: @wishlist %>
        </turbo-frame>
        <% if @wishlist.user != current_user %>
          <span class="owner-info">
            Created by <%= @wishlist.user.name.presence || @wishlist.user.email.split('@').first.humanize %>
          </span>
        <% end %>
      </div>
    </div>
  </header>

  <main class="main-content">
    <!-- Wishlist Items Section -->
    <section class="items-section">
      <div class="section-card">
        <div class="section-header">
          <h2 class="section-title">Wishlist Items</h2>
          <turbo-frame id="section_item_count">
            <%= render "section_count", wishlist: @wishlist %>
          </turbo-frame>
        </div>

        <% if @wishlist.wishlist_items.any? %>
          <turbo-frame id="wishlist_items_container">
            <div class="items-grid">
              <% @wishlist.wishlist_items.each do |item| %>
                <turbo-frame id="wishlist_item_<%= item.id %>">
                  <%= render "wishlist_items/item", item: item, wishlist: @wishlist %>
                </turbo-frame>
              <% end %>
            </div>
          </turbo-frame>
        <% else %>
          <turbo-frame id="empty_state">
            <div class="empty-state">
              <div class="empty-icon">üìù</div>
              <h3 class="empty-title">No items yet</h3>
              <p class="empty-description">
                <% if @wishlist.user == current_user %>
                  Start adding items to your wishlist! Your friends will be able to see what you're wishing for.
                <% else %>
                  This wishlist doesn't have any items yet.
                <% end %>
              </p>
            </div>
          </turbo-frame>
        <% end %>
      </div>
    </section>

    <!-- Owner-only sections -->
    <% if @wishlist.user == current_user %>
      <!-- Add Items Section -->
      <section class="add-items-section">
        <div class="section-card">
          <h2 class="section-title">Add New Items</h2>
          <p class="section-description">Add items to your wishlist that friends can see and purchase for you</p>
          <turbo-frame id="new_wishlist_item">
            <%= render "wishlist_items/form", wishlist: @wishlist, wishlist_item: WishlistItem.new %>
          </turbo-frame>
        </div>
      </section>

      <!-- Share Wishlist Section -->
      <section class="sharing-section">
        <div class="section-card">
          <h2 class="section-title">Share with Friends</h2>
          <p class="section-description">Invite friends to view your wishlist and help with gift ideas</p>

          <turbo-frame id="sharing_form">
            <%= render "sharing_form", wishlist: @wishlist %>
          </turbo-frame>

          <!-- Shared Users List -->
          <turbo-frame id="shared_users_list">
            <%= render "shared_users", wishlist: @wishlist %>
          </turbo-frame>
        </div>
      </section>
    <% end %>
  </main>
</div>